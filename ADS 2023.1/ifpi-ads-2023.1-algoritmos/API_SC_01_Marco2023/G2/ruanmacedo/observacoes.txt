1. Lógica OK.
2. Organizar o código em funcoes.